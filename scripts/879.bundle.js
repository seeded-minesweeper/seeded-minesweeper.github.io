"use strict";(self.webpackChunkminesweeper=self.webpackChunkminesweeper||[]).push([[879],{6(e,t,s){function*r(e){for(;;){let t=e+=1831565813;t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),yield((t^t>>>14)>>>0)/4294967296}}function i(e){let t=0;for(let s=0;s<e.length;s++)t+=Math.pow(31*e[s].charCodeAt(0),e.length-s),t&=t;return t}s.d(t,{BH:()=>r,s5:()=>i,yN:()=>o});let n=(e,t)=>({x:e,y:t});const o=[n(-1,0),n(1,0),n(0,-1),n(0,1),n(-1,-1),n(-1,1),n(1,-1),n(1,1)]},879(e,t,s){s.r(t),s.d(t,{default:()=>n});var r=s(6);class i{row=0;col=0;rigged=!1;opened=!1;flagged=!1;mineCount=0;chainCount;neighbours=[];updateMineCount(){this.mineCount=this.rigged?"M":this.neighbours.filter(e=>e.rigged).length}updateNeighbours(){this.neighbours=r.yN.map(e=>this.game.sqrAt(this.row+e.x,this.col+e.y)).filter(e=>e)}constructor(e,t,s){this.game=e,this.row=t,this.col=s}}class n{sqrs=[];openedArr=[];type="standard";get started(){return this.sqrs.some(e=>1==e.opened)}get rigged(){return this.sqrs.filter(e=>e.rigged)}get opened(){return this.sqrs.filter(e=>e.opened&&!e.rigged)}get won(){return this.sqrs.every(e=>e.opened&&!e.rigged||e.rigged&&!e.opened)}get failed(){return this.sqrs.some(e=>e.opened&&e.rigged)}get ended(){return this.failed||this.won}get fullSeed(){return n.getFullSeed(this.rows,this.cols,this.mines,this.seed)}constructor(e,t,s,r){if("number"==typeof e)this.rows=e,this.cols=t,this.seed=r,this.mines=s;else{let{rows:e,cols:t,mines:s,seed:r}=n.decodeFullSeed(arguments[0]);this.rows=e,this.cols=t,this.seed=r,this.mines=s}this.flagCount=this.mines,this.createSqrs(),this.rigSquares(),this.sqrs.forEach(e=>{e.updateNeighbours(),e.updateMineCount()})}createSqrs(){this.sqrs=new Array(this.rows*this.cols).fill();let e=1,t=1;this.sqrs.forEach((s,r)=>{this.sqrs[r]=new i(this,e,t),(r+1)%this.cols==0?(e++,t=1):t++})}rigSquares(){let e=isNaN(Number(this.seed))?(0,r.s5)(this.seed):Number(this.seed),t=(0,r.BH)(e*this.mines);this.sqrs.map(e=>e).sort(()=>t.next().value>t.next().value?1:-1).reverse().sort(()=>t.next().value>t.next().value?-1:1).slice(0,this.mines).forEach(e=>e.rigged=!0),t.return()}sqrAt(e,t){let s=(e,t)=>e>0&&e<=t;if(s(e,this.rows)&&s(t,this.cols))return this.sqrs[this.cols*(e-1)+(t-1)]}openSqr(e,t){let s=this.sqrAt(e,t);if(this.openedArr.forEach(e=>e.chainCount=null),this.openedArr=[],!this.ended&&s){if(s.chainCount=0,s.opened||s.flagged){let e=s.neighbours.filter(e=>!e.flagged&&!e.opened),t=s.neighbours.filter(e=>e.flagged).length;s.mineCount==t&&e.forEach(e=>{e.chainCount=0,this.openedArr.push(e)})}else this.openedArr.push(s);for(const e of this.openedArr)if(e.opened=!0,e.mineCount||e.neighbours.forEach(t=>{t.opened||t.flagged||null!=t.chainCount||(t.chainCount=e.chainCount+1,this.openedArr.push(t))}),e.opened&&e.rigged)break}}flagSqr(e,t){let s=this.sqrAt(e,t);s&&!s.opened&&!s.flagged&&this.flagCount&&!this.ended&&this.started&&(s.flagged=!0,this.flagCount--)}unflagSqr(e,t){let s=this.sqrAt(e,t);s&&s.flagged&&!this.ended&&(s.flagged=!1,this.flagCount++)}toggleFlag(e,t){let s=this.sqrAt(e,t);s&&(s.flagged?this.unflagSqr(s.row,s.col):this.flagSqr(s.row,s.col))}getStringData(){let e="";return e+=this.seed+"\n",this.sqrs.forEach(t=>{let s=t.opened?"o":t.flagged?"f":"c";t.rigged&&(s=s.toUpperCase()),e+=s,t.col==this.cols&&t.row!=this.rows&&(e+="\n")}),e}static getFullSeed(e,t,s,i){let n=e.toString(16)+"#"+t.toString(16)+"#"+s.toString(16)+"#"+(isNaN(Number(i))?(0,r.s5)(i):Number(i)).toString(16),o=(0,r.BH)(n.length);return n.split("").sort(()=>o.next().value>.5?1:-1).join("")}static decodeFullSeed(e){let t=(0,r.BH)(e.length),s=new Array(e.length).fill().map((e,t)=>t).sort(()=>t.next().value>.5?1:-1),i=s.map((t,r)=>e[s.indexOf(r)]).join("").split("#");function n(e){if(e){let t=e.replace("-",""),s=e.includes("-");return Number("0x"+t)*(s?-1:1)}}return{rows:n(i[0]),cols:n(i[1]),mines:n(i[2]),seed:n(i[3])}}static isValidSeed(e){let t=n.decodeFullSeed(e);return!(isNaN(t.rows)||isNaN(t.cols)||isNaN(t.mines)||isNaN(t.seed))}static createFromString(e){let t=e.split("\n"),s=t.length-1,r=t[1].length,i=new n(s,r,0,t[0]);for(const e of i.sqrs){let s=t[e.row][e.col-1],r=s.toLowerCase()!=s;switch(s=s.toLowerCase(),e.rigged=r,r&&(i.mines++,i.flagCount++),s){case"o":e.opened=!0;break;case"f":e.flagged=!0,i.flagCount--}}return i.sqrs.forEach(e=>{e.updateMineCount(),e.updateNeighbours()}),i}}}}]);